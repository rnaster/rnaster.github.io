---
title: Week07 Day33
tags:
  - BoostCamp-ai-tech
  - Week07
  - object detection
  - R-CNN
  - fast R-CNN
  - faster R-CNN
  - YOLO
  - SSD
  - Focal loss
  - RetinaNet
---

### object detection [^1]
> Object detection is a computer technology related to computer vision and image processing that deals with detecting instances of semantic objects of a certain class (such as humans, buildings, or cars) in digital images and videos.  
Well-researched domains of object detection include face detection and pedestrian detection.  
Object detection has applications in many areas of computer vision, including image retrieval and video surveillance.

object detection은 디지털 이미지 혹은 비디오에서 특정 class(인간, 건물 혹은 차와 같은)의 semantic object들의 객체를 탐지하는데 사용하는 컴퓨터 비전과 이미지 처리에 관련된 컴퓨터 기술이다.  
object detection 연구가 활발한 분야는 얼굴 탐지와 보행자 탐지이다.  
object detection은 이미지 검색과 비디오 감시를 포함하여 컴퓨터 비전의 많은 영역에서 응용을 하고 있다.  
참고로 [이 글](https://www.facefirst.com/blog/face-detection-vs-face-recognition/)을 보면 face recognition과 face detection의 차이점을 설명한다.  
똑같은 줄 알았는데 face detection은 좀 더 넓은 의미의 face recognition이다.  
단순하게 이미지나 비디오에서 얼굴을 탐지하는 것이다.  
face recognition은 누구의 얼굴인지 구분하는 biometric technology이다.  

![](https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Detected-with-YOLO--Schreibtisch-mit-Objekten.jpg/1200px-Detected-with-YOLO--Schreibtisch-mit-Objekten.jpg)  
위 그림은 object detection의 예시이다.  
원하는 것은 이미지 혹은 비디오에서 객체를 인식해서 탐지하고 분류하는 것이다.  
탐지하기 위해서는 객체를 포함하는 가장 작은 box가 필요하다.  
그리고 박스 안 객체가 어떤 class에 속하는지 분류해야 된다.  
즉 필요한 것은 class와 box를 표현할 좌표이다.  
이때 좌표는 (x, y) 두 쌍이 필요하다, 왼쪽 위와 오른쪽 아래.  

신경망을 사용하기 전 전통적인 object detection 방법 두가지를 소개한다.  
- HOG(Histogram Of Gradient)  
나중에 추가...
- selective search  
나중에 추가...

신경망을 사용하여 이를 구현하는 architecture가 두가지, two-stage, single-stage detection, 가 있다.  
먼저 two-stage detection 기법들을 살펴본다.  

### R-CNN(Regions with CNN features) [^2]
신경망을 이용한 object detection 모델의 지평을 열었다.  
기존의 방법들보다 좋은 성능을 보였다.  
![](/assets/images/66.PNG)  
R-CNN의 과정을 설명하면 다음과 같다.  
1. 이미지를 입력한다.  
2. 이미지에 대해 region proposal을 여러 개 추출한다.  
window sliding으로 이미지를 추출해서 모든 부분을 고려한다면 정확한 영역을 구할 수 있겠지만 계산량이 어마어마할 것이다.  
그래서 R-CNN과 관련 없는 알고리즘, 이 논문에서는 selective search 사용함,으로 입력 이미지에 대해 약 2,000개의 region proposal을 추출한다.  
selective search가 이미지를 보고 객체가 있을법한 부분을 crop해준다.  
이 과정에서 시간이 많이 걸린다.  
3. 추출된 proposal을 정해진 크기로 resize하고 CNN으로 feature vector를 계산한다.  
추출된 proposal은 서로 다른 크기를 갖는다.  
CNN에 넣기 위해 일정한 크기를 가져야 하기 위해 resize를 한다.  
그리고 사전에 학습된 CNN(오래된 논문이라 AlexNet을 사용함)을 사용하여 proposal에 대한 feature vector를 계산한다.  
4. class 예측과 bounding-box regression을 했다.  
예측은 linear SVM을 사용했다.  

과정은 간단해 보이지만 어려운 점이 있다.  
이미지 내 proposal을 찾는 과정이다.  
proposal은 신경망과 상관없는 알고리즘에 의해 얻으므로 end-to-end 모델이 아니다.  
또한 한 이미지(original image)에 대해 여러 개의 이미지(proposal)를 추출하고 이 갯수만큼 CNN을 계산한다.  
이 부분에서 많은 bottleneck이 생긴다.  
그래서 GPU로 실행하면 대략 이미지 한 장에 13초가 걸렸다.  

AlexNet처럼 기존 object detection 방법에 비해 좋은 성능을 보였다.  
먼저 입력을 넣고 region proposal을 2,000개 이하 구한다.  
그리고 적절한 사이즈로 wrap을 하고 CNN에 입력한다, 예를 들어 224x224 처럼.  
이때 CNN은 pre-trained 모델이다.  
FC layer의 벡터를 linear SVM에 넣어 학습을 했다.  
CNN은 feature 벡터 추출용이다.  
단점은 많은 region proposal에 대해 학습을 하는 것과 사람의 지식이 들어간 proposal이므로 성능 향상에 한계가 존재했다.  

#### 학습방법
나중에 추가...

### fast R-CNN
나중에 추가...

### faster R-CNN
나중에 추가...

### YOLO(You Only Look Once)
나중에 추가...

### SSD(Single Shot Detection)
나중에 추가...

[^1]: [object detection](https://en.wikipedia.org/wiki/Object_detection)  
[^2]: [Rich feature hierarchies for accurate object detection and semantic segmentation
](https://arxiv.org/abs/1311.2524)  
